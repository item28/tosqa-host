(function() {
  var circuitsCtrl, ng,
    __slice = [].slice;

  ng = angular.module('myApp');

  ng.config(function($stateProvider, navbarProvider) {
    $stateProvider.state('circuits', {
      url: '/circuits',
      templateUrl: '/circuits/circuits.html',
      controller: circuitsCtrl
    });
    return navbarProvider.add('/circuits', 'Circuits', 30);
  });

  circuitsCtrl = function($scope, jeebus) {
    var handlers, obj, setup, updatePinList;
    $scope.circuits = {};
    $scope.gadgets = {
      Pipe: {
        name: 'Pipeline',
        shade: 'lightyellow',
        icon: '\uf061',
        inputs: 'In',
        outputs: 'Out'
      },
      Printer: {
        shade: 'lightblue',
        icon: '\uf02f',
        inputs: 'In In2'
      },
      StepGen: {
        shade: 'lightgreen',
        icon: '\uf013',
        inputs: 'Params',
        outputs: 'Out'
      },
      SSB: {
        shade: 'lightgray',
        icon: '\uf0b2',
        inputs: 'Cmds'
      }
    };
    $scope.circuit = {
      gadgets: {
        g1: {
          x: 120,
          y: 220,
          title: 'Gadget One',
          type: 'Pipe'
        },
        g2: {
          x: 300,
          y: 250,
          title: 'Gadget Two',
          type: 'Printer'
        },
        g3: {
          x: 320,
          y: 60,
          title: 'StepGen-X',
          type: 'StepGen'
        },
        g4: {
          x: 540,
          y: 70,
          title: 'SSB-X',
          type: 'SSB'
        },
        g5: {
          x: 340,
          y: 140,
          title: 'StepGen-Y',
          type: 'StepGen'
        },
        g6: {
          x: 520,
          y: 150,
          title: 'SSB-Y',
          type: 'SSB'
        }
      },
      wires: {
        'g1.Out/g2.In': 0,
        'g3.Out/g4.Cmds': 0,
        'g5.Out/g6.Cmds': 0
      },
      feeds: {
        'g2.In': [
          'some data', {
            Tag: 'blah',
            Msg: 'tagged data'
          }
        ],
        'g3.Params': [1000, 500],
        'g5.Params': [500, 1000]
      },
      labels: {
        In: 'g2.In'
      }
    };
    $scope.circuit = {
      gadgets: {}
    };
    updatePinList = function() {
      var g, gid, ins, p, _i, _len, _ref, _ref1;
      $scope.inputPins = [];
      _ref = $scope.circuit.gadgets;
      for (gid in _ref) {
        g = _ref[gid];
        if (ins = $scope.gadgets[g.type].inputs) {
          _ref1 = ins.split(' ');
          for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
            p = _ref1[_i];
            $scope.inputPins.push("" + gid + "." + p);
          }
        }
      }
      return $scope.inputPins.sort();
    };
    $scope.$watch("circuit", (function(newNames, oldNames) {
      return console.log("$watch circuit change");
    }), true);
    $scope.$watch("circuits", (function(newValue, oldValue) {
      var each, old, _i, _len, _results;
      old = Object.keys(oldValue);
      angular.forEach(newValue, function(value, key) {
        var index;
        if (old.indexOf(key === -1)) {
          $scope.circuit.gadgets[key] = value;
          console.log("object " + key + " is added", value);
        }
        index = old.indexOf(key);
        if (index > -1) {
          return old.splice(index, 1);
        }
      });
      _results = [];
      for (_i = 0, _len = old.length; _i < _len; _i++) {
        each = old[_i];
        _results.push(console.log("this key is removed:", key));
      }
      return _results;
    }), true);
    $scope.$watch('addPin', function(pin) {
      var _base;
      if (pin) {
        if ((_base = $scope.circuit.feeds)[pin] == null) {
          _base[pin] = [];
        }
        console.log('addFeed', pin, $scope.circuit.feeds[pin].length);
        $scope.circuit.feeds[pin].push('');
        return $scope.addPin = null;
      }
    });
    $scope.delFeed = function(pin, index) {
      var items;
      items = $scope.circuit.feeds[pin];
      console.log('delFeed', pin, index, items[index]);
      items.splice(index, 1);
      if (items.length === 0) {
        return delete $scope.circuit.feeds[pin];
      }
    };
    $scope.$watch('currSel.id', function(x) {
      console.log('fix id', x);
      return updatePinList();
    });
    $scope.$watch('currSel.title', function(x) {
      return console.log('fix title', x);
    });
    obj = 'demo1';
    handlers = {
      addGadget: function(x, y) {
        var date, id, type;
        if ($scope.newtype != null) {
          date = String(Date.now());
          id = "g" + date;
          type = $scope.newtype;
          obj = {
            title: "" + type + "-" + id,
            type: $scope.newtype,
            x: x,
            y: y
          };
          return jeebus.put("/circuit/demo1/" + id, obj);
        }
      },
      delGadget: function(id) {
        return jeebus.put("/circuit/demo1/" + id);
      },
      addWire: function(from, to) {},
      delWire: function(from, to) {},
      selectGadget: function(id) {},
      moveGadget: function(id, x, y) {}
    };
    $scope.$on('circuit', function() {
      var args, event, type;
      event = arguments[0], type = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      console.log.apply(console, ['C:', type].concat(__slice.call(args)));
      return handlers[type].apply(handlers, args);
    });
    setup = function() {
      return jeebus.attach('circuit').on('sync', function() {
        var args, temp, _i, _len, _results;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        temp = this.rows;
        console.log("init circuits");
        _results = [];
        for (_i = 0, _len = temp.length; _i < _len; _i++) {
          obj = temp[_i];
          _results.push($scope.circuits[obj.id] = obj);
        }
        return _results;
      }).on('data', function() {
        var args;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        return console.log(111, args);
      });
    };
    if ($scope.serverStatus === 'connected') {
      setup();
    }
    return $scope.$on('ws-open', setup);
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY3VpdHMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxnQkFBQTtJQUFBLGtCQUFBOztBQUFBLEVBQUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxNQUFSLENBQWUsT0FBZixDQUFMLENBQUE7O0FBQUEsRUFFQSxFQUFFLENBQUMsTUFBSCxDQUFVLFNBQUMsY0FBRCxFQUFpQixjQUFqQixHQUFBO0FBQ1IsSUFBQSxjQUFjLENBQUMsS0FBZixDQUFxQixVQUFyQixFQUNFO0FBQUEsTUFBQSxHQUFBLEVBQUssV0FBTDtBQUFBLE1BQ0EsV0FBQSxFQUFhLHlCQURiO0FBQUEsTUFFQSxVQUFBLEVBQVksWUFGWjtLQURGLENBQUEsQ0FBQTtXQUlBLGNBQWMsQ0FBQyxHQUFmLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLEVBQTRDLEVBQTVDLEVBTFE7RUFBQSxDQUFWLENBRkEsQ0FBQTs7QUFBQSxFQVNBLFlBQUEsR0FBZSxTQUFDLE1BQUQsRUFBUyxNQUFULEdBQUE7QUFFYixRQUFBLG1DQUFBO0FBQUEsSUFBQSxNQUFNLENBQUMsUUFBUCxHQUFpQixFQUFqQixDQUFBO0FBQUEsSUFFQSxNQUFNLENBQUMsT0FBUCxHQUNFO0FBQUEsTUFBQSxJQUFBLEVBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxVQUFOO0FBQUEsUUFDQSxLQUFBLEVBQU8sYUFEUDtBQUFBLFFBRUEsSUFBQSxFQUFNLFFBRk47QUFBQSxRQUdBLE1BQUEsRUFBUSxJQUhSO0FBQUEsUUFJQSxPQUFBLEVBQVMsS0FKVDtPQURGO0FBQUEsTUFNQSxPQUFBLEVBQ0U7QUFBQSxRQUFBLEtBQUEsRUFBTyxXQUFQO0FBQUEsUUFDQSxJQUFBLEVBQU0sUUFETjtBQUFBLFFBRUEsTUFBQSxFQUFRLFFBRlI7T0FQRjtBQUFBLE1BVUEsT0FBQSxFQUNFO0FBQUEsUUFBQSxLQUFBLEVBQU8sWUFBUDtBQUFBLFFBQ0EsSUFBQSxFQUFN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QU0sQ0FBQyxZQUFQLEtBQXVCLFdBQW5DO0FBQUEsTUFBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO0tBMUlBO1dBMklBLE1BQU0sQ0FBQyxHQUFQLENBQVcsU0FBWCxFQUFzQixLQUF0QixFQTdJYTtFQUFBLENBVGYsQ0FBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsibmcgPSBhbmd1bGFyLm1vZHVsZSAnbXlBcHAnXG5cbm5nLmNvbmZpZyAoJHN0YXRlUHJvdmlkZXIsIG5hdmJhclByb3ZpZGVyKSAtPlxuICAkc3RhdGVQcm92aWRlci5zdGF0ZSAnY2lyY3VpdHMnLFxuICAgIHVybDogJy9jaXJjdWl0cydcbiAgICB0ZW1wbGF0ZVVybDogJy9jaXJjdWl0cy9jaXJjdWl0cy5odG1sJ1xuICAgIGNvbnRyb2xsZXI6IGNpcmN1aXRzQ3RybFxuICBuYXZiYXJQcm92aWRlci5hZGQgJy9jaXJjdWl0cycsICdDaXJjdWl0cycsIDMwXG5cbmNpcmN1aXRzQ3RybCA9ICgkc2NvcGUsIGplZWJ1cykgLT5cbiAgXG4gICRzY29wZS5jaXJjdWl0cyA9e31cbiAgXG4gICRzY29wZS5nYWRnZXRzID1cbiAgICBQaXBlOlxuICAgICAgbmFtZTogJ1BpcGVsaW5lJ1xuICAgICAgc2hhZGU6ICdsaWdodHllbGxvdydcbiAgICAgIGljb246ICdcXHVmMDYxJyAjIGZhLWFycm93LXJpZ2h0XG4gICAgICBpbnB1dHM6ICdJbidcbiAgICAgIG91dHB1dHM6ICdPdXQnXG4gICAgUHJpbnRlcjpcbiAgICAgIHNoYWRlOiAnbGlnaHRibHVlJ1xuICAgICAgaWNvbjogJ1xcdWYwMmYnICMgZmEtcHJpbnRcbiAgICAgIGlucHV0czogJ0luIEluMidcbiAgICBTdGVwR2VuOlxuICAgICAgc2hhZGU6ICdsaWdodGdyZWVuJ1xuICAgICAgaWNvbjogJ1xcdWYwMTMnICMgZmEtY29nXG4gICAgICBpbnB1dHM6ICdQYXJhbXMnXG4gICAgICBvdXRwdXRzOiAnT3V0J1xuICAgIFNTQjpcbiAgICAgIHNoYWRlOiAnbGlnaHRncmF5J1xuICAgICAgaWNvbjogJ1xcdWYwYjInICMgZmEtYXJyb3dzLWFsdFxuICAgICAgaW5wdXRzOiAnQ21kcydcbiAgICAgIFxuICAkc2NvcGUuY2lyY3VpdCA9XG4gICAgZ2FkZ2V0czpcbiAgICAgIGcxOiB7IHg6IDEyMCwgeTogMjIwLCB0aXRsZTogJ0dhZGdldCBPbmUnLCB0eXBlOiAnUGlwZScsICAgIH1cbiAgICAgIGcyOiB7IHg6IDMwMCwgeTogMjUwLCB0aXRsZTogJ0dhZGdldCBUd28nLCB0eXBlOiAnUHJpbnRlcicsIH1cbiAgICAgIGczOiB7IHg6IDMyMCwgeTogIDYwLCB0aXRsZTogJ1N0ZXBHZW4tWCcsICB0eXBlOiAnU3RlcEdlbicsIH1cbiAgICAgIGc0OiB7IHg6IDU0MCwgeTogIDcwLCB0aXRsZTogJ1NTQi1YJywgICAgICB0eXBlOiAnU1NCJywgICAgIH1cbiAgICAgIGc1OiB7IHg6IDM0MCwgeTogMTQwLCB0aXRsZTogJ1N0ZXBHZW4tWScsICB0eXBlOiAnU3RlcEdlbicsIH1cbiAgICAgIGc2OiB7IHg6IDUyMCwgeTogMTUwLCB0aXRsZTogJ1NTQi1ZJywgICAgICB0eXBlOiAnU1NCJywgICAgIH1cbiAgICB3aXJlczpcbiAgICAgICdnMS5PdXQvZzIuSW4nOiAwXG4gICAgICAnZzMuT3V0L2c0LkNtZHMnOiAwXG4gICAgICAnZzUuT3V0L2c2LkNtZHMnOiAwXG4gICAgZmVlZHM6XG4gICAgICAnZzIuSW4nOiBbICdzb21lIGRhdGEnLCB7IFRhZzogJ2JsYWgnLCBNc2c6ICd0YWdnZWQgZGF0YScgfSBdXG4gICAgICAnZzMuUGFyYW1zJzogWyAxMDAwLCA1MDAgXVxuICAgICAgJ2c1LlBhcmFtcyc6IFsgNTAwLCAxMDAwIF1cbiAgICBsYWJlbHM6XG4gICAgICBJbjogJ2cyLkluJ1xuICAgICAgXG4gICRzY29wZS5jaXJjdWl0ID1cbiAgICBnYWRnZXRzOnt9IFxuICAgICAgXG4gIHVwZGF0ZVBpbkxpc3QgPSAoKSAtPlxuICAgICRzY29wZS5pbnB1dFBpbnMgPSBbXVxuICAgIGZvciBnaWQsIGcgb2YgJHNjb3BlLmNpcmN1aXQuZ2FkZ2V0c1xuICAgICAgaWYgaW5zID0gJHNjb3BlLmdhZGdldHNbZy50eXBlXS5pbnB1dHNcbiAgICAgICAgZm9yIHAgaW4gaW5zLnNwbGl0ICcgJ1xuICAgICAgICAgICRzY29wZS5pbnB1dFBpbnMucHVzaCBcIiN7Z2lkfS4je3B9XCJcbiAgICAkc2NvcGUuaW5wdXRQaW5zLnNvcnQoKVxuICBcbiAgIyAgdGVtcG9yYXJ5IHdhdGNoIHNjb3BlIGZvciBzdGF0ZWNoYW5nZVxuICAkc2NvcGUuJHdhdGNoIFwiY2lyY3VpdFwiLCAoKG5ld05hbWVzLCBvbGROYW1lcykgLT5cbiAgICBjb25zb2xlLmxvZyBcIiR3YXRjaCBjaXJjdWl0IGNoYW5nZVwiXG4gICksIHRydWVcbiAgXG4gICRzY29wZS4kd2F0Y2ggXCJjaXJjdWl0c1wiLCAoKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgLT5cbiAgICBvbGQgPSBPYmplY3Qua2V5cyBvbGRWYWx1ZVxuICAgIGFuZ3VsYXIuZm9yRWFjaCBuZXdWYWx1ZSwgKHZhbHVlLCBrZXkpIC0+XG4gICAgICBpZiBvbGQuaW5kZXhPZiBrZXkgaXMgLTEgIyBpZiBrZXkgZG9lcyBub3QgZXhpc3QgaW4gb2xkVmFsdWUsIGtleSBhZGRcbiAgICAgICAgJHNjb3BlLmNpcmN1aXQuZ2FkZ2V0c1trZXldID0gdmFsdWUgIyB7IHg6IHZhbHVlLngsIHk6IHZhbHVlLnksIHRpdGxlOiB2YWx1ZS50aXRsZSwgdHlwZTogdmFsdWUudHlwZSB9XG4gICAgICAgIGNvbnNvbGUubG9nIFwib2JqZWN0ICN7a2V5fSBpcyBhZGRlZFwiLCB2YWx1ZVxuXG4gICAgICBpbmRleCA9IG9sZC5pbmRleE9mKGtleSkgIyByZW1vdmUgaXRlbSBmcm9tIG9sZFxuICAgICAgaWYgaW5kZXggPiAtMVxuICAgICAgICBvbGQuc3BsaWNlIGluZGV4LCAxXG4gICAgZm9yIGVhY2ggaW4gb2xkICAjIG9sZCBub3cgY29udGFpbnMgYWxsIGtleXMgdGhhdCBkbyBubyBvbmdlciBleGlzdCBpbiBuZXdWYWx1ZVxuICAgICAgIyBpbmRleCA9ICRzY29wZS5jaXJjdWl0LmdhZGdldHMuaW5kZXhPZihlYWNoKVxuICAgICAgIyAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzLnNwbGljZSBpbmRleCwgMVxuICAgICAgY29uc29sZS5sb2cgXCJ0aGlzIGtleSBpcyByZW1vdmVkOlwiLCBrZXlcbiAgICAgICAgICAgIFxuICApLCB0cnVlXG4gIFxuICAkc2NvcGUuJHdhdGNoICdhZGRQaW4nLCAocGluKSAtPlxuICAgIGlmIHBpblxuICAgICAgJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXSA/PSBbXVxuICAgICAgY29uc29sZS5sb2cgJ2FkZEZlZWQnLCBwaW4sICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl0ubGVuZ3RoXG4gICAgICAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dLnB1c2ggJydcbiAgICAgICRzY29wZS5hZGRQaW4gPSBudWxsXG5cbiAgJHNjb3BlLmRlbEZlZWQgPSAocGluLCBpbmRleCkgLT5cbiAgICBpdGVtcyA9ICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl1cbiAgICBjb25zb2xlLmxvZyAnZGVsRmVlZCcsIHBpbiwgaW5kZXgsIGl0ZW1zW2luZGV4XVxuICAgIGl0ZW1zLnNwbGljZSBpbmRleCwgMVxuICAgIGRlbGV0ZSAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dICBpZiBpdGVtcy5sZW5ndGggaXMgMFxuICBcbiAgJHNjb3BlLiR3YXRjaCAnY3VyclNlbC5pZCcsICh4KSAtPlxuICAgIGNvbnNvbGUubG9nICdmaXggaWQnLCB4XG4gICAgdXBkYXRlUGluTGlzdCgpICMgZm9yIG5ldyBhbmQgZGVsZXRlZCBnYWRnZXRzXG4gICRzY29wZS4kd2F0Y2ggJ2N1cnJTZWwudGl0bGUnLCAoeCkgLT5cbiAgICBjb25zb2xlLmxvZyAnZml4IHRpdGxlJywgeFxuICAgIFxuICBvYmogPSAnZGVtbzEnXG4gIFxuICBoYW5kbGVycyA9XG4gICAgYWRkR2FkZ2V0OiAoeCwgeSkgLT4gICAgICBcbiAgICAgIGlmICRzY29wZS5uZXd0eXBlPyBcbiAgICAgICAgIyB7XCJmZWVkXCI6e1wiUGFyYW1zXCI6WzEwMDAsNTAwXX0sXCJ0aXRsZVwiOlwiU3RlcEdlbi1YXCIsXCJ0eXBlXCI6XCJTdGVwR2VuXCIsXCJ3aXJlXCI6e1wiT3V0XCI6XCJnNC5DbWRzXCJ9LFwieFwiOjMyMCxcInlcIjo2MH1cbiAgICAgICAgZGF0ZSA9IFN0cmluZyBEYXRlLm5vdygpIFxuICAgICAgICBpZD0gXCJnXCIgKyBkYXRlICNkYXRlLnN1YnN0cihkYXRlIC5sZW5ndGggLSA5KSAjID0+IFwiVGFiczFcIlxuICAgICAgICB0eXBlID0gJHNjb3BlLm5ld3R5cGVcbiAgICAgICAgb2JqID0ge3RpdGxlOlwiI3t0eXBlfS0je2lkfVwiLCB0eXBlOiRzY29wZS5uZXd0eXBlLCB4OngsIHk6eX1cblxuICAgICAgICAjIGplZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWFnJywgb2JqfVxuICAgICAgICBqZWVidXMucHV0IFwiL2NpcmN1aXQvZGVtbzEvI3tpZH1cIiwgb2JqIFxuICAgIGRlbEdhZGdldDogKGlkKSAtPiAgICAgICAgXG4gICAgICAjIGplZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWRnJywgb2JqLCBpZH1cbiAgICAgICMgcHV0IG5pbCB2YWx1ZSB0byBkZWxldGUgaWRcbiAgICAgIGplZWJ1cy5wdXQgXCIvY2lyY3VpdC9kZW1vMS8je2lkfVwiICBcbiAgICBhZGRXaXJlOiAoZnJvbSwgdG8pIC0+ICAgICNqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1hdycsIG9iaiwgZnJvbSwgdG8gfVxuICAgIGRlbFdpcmU6IChmcm9tLCB0bykgLT4gICAgI2plZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWR3Jywgb2JqLCBmcm9tLCB0byB9XG4gICAgc2VsZWN0R2FkZ2V0OiAoaWQpIC0+ICAgICAjamVlYnVzLnNlbmQgeyBjbWQ6ICdjZWQtc2cnLCBvYmosIGlkICAgICAgIH1cbiAgICBtb3ZlR2FkZ2V0OiAoaWQsIHgsIHkpIC0+ICNqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1tZycsIG9iaiwgaWQsIHgsIHkgfVxuXG4gICRzY29wZS4kb24gJ2NpcmN1aXQnLCAoZXZlbnQsIHR5cGUsIGFyZ3MuLi4pIC0+XG4gICAgY29uc29sZS5sb2cgJ0M6JywgdHlwZSwgYXJncy4uLlxuICAgIGhhbmRsZXJzW3R5cGVdIGFyZ3MuLi5cbiAgICBcbiAgc2V0dXAgPSAtPlxuICAgIGplZWJ1cy5hdHRhY2ggJ2NpcmN1aXQnXG4gICAgICAub24gJ3N5bmMnLCAoYXJncy4uLikgLT5cbiAgICAgICAgdGVtcCA9IEByb3dzXG4gICAgICAgIGNvbnNvbGUubG9nIFwiaW5pdCBjaXJjdWl0c1wiXG4gICAgICAgIGZvciBvYmogaW4gdGVtcFxuICAgICAgICAgICRzY29wZS5jaXJjdWl0c1tvYmouaWRdID0gb2JqIFxuICBcbiAgICAgIC5vbiAnZGF0YScsIChhcmdzLi4uKSAtPiBcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nIDExMSwgYXJnc1xuICAgICAgXG4gICAgICAgICMxLiBUT0RPOiBjaGVjayBmb3IgdmFsdWUsIGVsc2UgcmVtb3ZlXG4gICAgICAgICMyLiBhZGQgdG8gY2lyY3VpdHNcbiAgICAgICAgIyAkc2NvcGUuY2lyY3VpdHMgcHVzaCBrLCB2XG4gICAgICAgICMzLiB0ZWxsIGVkaXRvclxuXG5cbiAgc2V0dXAoKSAgaWYgJHNjb3BlLnNlcnZlclN0YXR1cyBpcyAnY29ubmVjdGVkJ1xuICAkc2NvcGUuJG9uICd3cy1vcGVuJywgc2V0dXBcbiJdfQ==
