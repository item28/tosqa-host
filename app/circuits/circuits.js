(function() {
  var circuitsCtrl, ng,
    __slice = [].slice;

  ng = angular.module('myApp');

  ng.config(function($stateProvider, navbarProvider) {
    $stateProvider.state('circuits', {
      url: '/circuits',
      templateUrl: '/circuits/circuits.html',
      controller: circuitsCtrl
    });
    return navbarProvider.add('/circuits', 'Circuits', 30);
  });

  circuitsCtrl = function($scope, jeebus) {
    var handlers, setup, updatePinList;
    $scope.circuits = {};
    $scope.gadgets = {
      Pipe: {
        name: 'Pipeline',
        shade: 'lightyellow',
        icon: '\uf061',
        inputs: 'In',
        outputs: 'Out'
      },
      Printer: {
        shade: 'lightblue',
        icon: '\uf02f',
        inputs: 'In In2'
      },
      clock: {
        shade: 'pink',
        icon: '\uf017',
        inputs: 'Rate',
        outputs: 'Out'
      },
      StepGen: {
        shade: 'lightgreen',
        icon: '\uf013',
        inputs: 'Params',
        outputs: 'Out'
      },
      SSB: {
        shade: 'lightgray',
        icon: '\uf0b2',
        inputs: 'Cmds'
      }
    };
    $scope.circuit = {
      gadgets: {
        g1: {
          x: 120,
          y: 220,
          title: 'Gadget One',
          type: 'Pipe'
        },
        g2: {
          x: 300,
          y: 250,
          title: 'Gadget Two',
          type: 'Printer'
        },
        g3: {
          x: 320,
          y: 60,
          title: 'StepGen-X',
          type: 'StepGen'
        },
        g4: {
          x: 540,
          y: 70,
          title: 'SSB-X',
          type: 'SSB'
        },
        g5: {
          x: 340,
          y: 140,
          title: 'StepGen-Y',
          type: 'StepGen'
        },
        g6: {
          x: 520,
          y: 150,
          title: 'SSB-Y',
          type: 'SSB'
        }
      },
      wires: {
        'g1.Out/g2.In': 0,
        'g3.Out/g4.Cmds': 0,
        'g5.Out/g6.Cmds': 0
      },
      feeds: {
        'g2.In': [
          'some data', {
            Tag: 'blah',
            Msg: 'tagged data'
          }
        ],
        'g3.Params': [1000, 500],
        'g5.Params': [500, 1000]
      },
      labels: {
        In: 'g2.In'
      }
    };
    $scope.circuit = {
      gadgets: {},
      wires: [],
      feeds: []
    };
    updatePinList = function() {
      var g, gid, ins, p, _i, _len, _ref, _ref1;
      $scope.inputPins = [];
      _ref = $scope.circuit.gadgets;
      for (gid in _ref) {
        g = _ref[gid];
        if (ins = $scope.gadgets[g.type].inputs) {
          _ref1 = ins.split(' ');
          for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
            p = _ref1[_i];
            $scope.inputPins.push("" + gid + "." + p);
          }
        }
      }
      return $scope.inputPins.sort();
    };
    $scope.$watch("circuits", (function(newValue, oldValue) {
      var each, old, _i, _len, _results;
      old = Object.keys(oldValue);
      angular.forEach(newValue, function(value, key) {
        var index, k;
        if (old.indexOf(key === -1)) {
          $scope.circuit.gadgets[key] = value;
          console.log("object " + key + " is added", value);
          if (value.wire != null) {
            console.log("wires:", value.wire);
            k = "" + key + ".Out/" + value.wire.Out;
            $scope.circuit.wires[k] = 0;
          }
          if (value.feed != null) {
            console.log(value.feed);
            $scope.circuit.feeds.push(value.feed);
          }
        }
        index = old.indexOf(key);
        if (index > -1) {
          return old.splice(index, 1);
        }
      });
      _results = [];
      for (_i = 0, _len = old.length; _i < _len; _i++) {
        each = old[_i];
        _results.push(console.log("this key is removed:", key));
      }
      return _results;
    }), true);
    $scope.$watch('addPin', function(pin) {
      var _base;
      if (pin) {
        if ((_base = $scope.circuit.feeds)[pin] == null) {
          _base[pin] = [];
        }
        console.log('addFeed', pin, $scope.circuit.feeds[pin].length);
        $scope.circuit.feeds[pin].push('');
        return $scope.addPin = null;
      }
    });
    $scope.delFeed = function(pin, index) {
      var items;
      items = $scope.circuit.feeds[pin];
      console.log('delFeed', pin, index, items[index]);
      items.splice(index, 1);
      if (items.length === 0) {
        return delete $scope.circuit.feeds[pin];
      }
    };
    $scope.$watch('currSel.id', function(x) {
      console.log('fix id', x);
      return updatePinList();
    });
    $scope.$watch('currSel.title', function(x) {
      return console.log('fix title', x);
    });
    handlers = {
      addGadget: function(x, y) {
        var id, obj, type;
        if ($scope.newtype != null) {
          id = "g" + String(Date.now() % 1234567);
          type = $scope.newtype;
          obj = {
            title: "" + type + "-" + id,
            type: $scope.newtype,
            x: x,
            y: y
          };
          return jeebus.put("/circuit/demo1/" + id, obj);
        }
      },
      delGadget: function(id) {
        return jeebus.put("/circuit/demo1/" + id);
      },
      addWire: function(from, to) {
        var id, obj;
        id = (from.split('.'))[0];
        obj = $scope.circuit.gadgets[id];
        obj.wire = {
          "Out": to
        };
        return jeebus.put("/circuit/demo1/" + id, obj);
      },
      delWire: function(from, to) {
        var id, obj;
        id = (from.split('.'))[0];
        obj = $scope.circuit.gadgets[id];
        obj.wire = null;
        return jeebus.put("/circuit/demo1/" + id, obj);
      },
      selectGadget: function(id) {},
      moveGadget: function(id, x, y) {
        var obj;
        obj = $scope.circuit.gadgets[id];
        obj.x = x;
        obj.y = y;
        return jeebus.put("/circuit/demo1/" + id, obj);
      }
    };
    $scope.$on('circuit', function() {
      var args, event, type;
      event = arguments[0], type = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      console.log.apply(console, ['C:', type].concat(__slice.call(args)));
      return handlers[type].apply(handlers, args);
    });
    setup = function() {
      return jeebus.attach('circuit/demo1').on('sync', function() {
        var args, obj, temp, _i, _len;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        temp = this.rows;
        for (_i = 0, _len = temp.length; _i < _len; _i++) {
          obj = temp[_i];
          $scope.circuits[obj.id] = obj;
        }
        return console.log("init circuits");
      }).on('data', function() {
        var args;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        return console.log(111, args);
      });
    };
    if ($scope.serverStatus === 'connected') {
      setup();
    }
    return $scope.$on('ws-open', setup);
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY3VpdHMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxnQkFBQTtJQUFBLGtCQUFBOztBQUFBLEVBQUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxNQUFSLENBQWUsT0FBZixDQUFMLENBQUE7O0FBQUEsRUFFQSxFQUFFLENBQUMsTUFBSCxDQUFVLFNBQUMsY0FBRCxFQUFpQixjQUFqQixHQUFBO0FBQ1IsSUFBQSxjQUFjLENBQUMsS0FBZixDQUFxQixVQUFyQixFQUNFO0FBQUEsTUFBQSxHQUFBLEVBQUssV0FBTDtBQUFBLE1BQ0EsV0FBQSxFQUFhLHlCQURiO0FBQUEsTUFFQSxVQUFBLEVBQVksWUFGWjtLQURGLENBQUEsQ0FBQTtXQUlBLGNBQWMsQ0FBQyxHQUFmLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLEVBQTRDLEVBQTVDLEVBTFE7RUFBQSxDQUFWLENBRkEsQ0FBQTs7QUFBQSxFQVNBLFlBQUEsR0FBZSxTQUFDLE1BQUQsRUFBUyxNQUFULEdBQUE7QUFFYixRQUFBLDhCQUFBO0FBQUEsSUFBQSxNQUFNLENBQUMsUUFBUCxHQUFpQixFQUFqQixDQUFBO0FBQUEsSUFFQSxNQUFNLENBQUMsT0FBUCxHQUNFO0FBQUEsTUFBQSxJQUFBLEVBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxVQUFOO0FBQUEsUUFDQSxLQUFBLEVBQU8sYUFEUDtBQUFBLFFBRUEsSUFBQSxFQUFNLFFBRk47QUFBQSxRQUdBLE1BQUEsRUFBUSxJQUhSO0FBQUEsUUFJQSxPQUFBLEVBQVMsS0FKVDtPQURGO0FBQUEsTUFNQSxPQUFBLEVBQ0U7QUFBQSxRQUFBLEtBQUEsRUFBTyxXQUFQO0FBQUEsUUFDQSxJQUFBLEVBQU0sUUFETjtBQUFBLFFBRUEsTUFBQSxFQUFRLFFBRlI7T0FQRjtBQUFBLE1BVUEsS0FBQSxFQUNFO0FBQUEsUUFBQSxLQUFBLEVBQU8sTUFBUDtBQUFBLFFBQ0EsSUFBQSxFQUFN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QUcsQ0FBQyxFQUFKLENBQWhCLEdBQTBCLEdBQTFCLENBREY7QUFBQSxTQURBO2VBR0EsT0FBTyxDQUFDLEdBQVIsQ0FBWSxlQUFaLEVBSlM7TUFBQSxDQURiLENBT0MsQ0FBQyxFQVBGLENBT0ssTUFQTCxFQU9hLFNBQUEsR0FBQTtBQUNULFlBQUEsSUFBQTtBQUFBLFFBRFUsOERBQ1YsQ0FBQTtlQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksR0FBWixFQUFpQixJQUFqQixFQURTO01BQUEsQ0FQYixFQURNO0lBQUEsQ0E5SVIsQ0FBQTtBQWtLQSxJQUFBLElBQVksTUFBTSxDQUFDLFlBQVAsS0FBdUIsV0FBbkM7QUFBQSxNQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUE7S0FsS0E7V0FtS0EsTUFBTSxDQUFDLEdBQVAsQ0FBVyxTQUFYLEVBQXNCLEtBQXRCLEVBckthO0VBQUEsQ0FUZixDQUFBO0FBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJuZyA9IGFuZ3VsYXIubW9kdWxlICdteUFwcCdcblxubmcuY29uZmlnICgkc3RhdGVQcm92aWRlciwgbmF2YmFyUHJvdmlkZXIpIC0+XG4gICRzdGF0ZVByb3ZpZGVyLnN0YXRlICdjaXJjdWl0cycsXG4gICAgdXJsOiAnL2NpcmN1aXRzJ1xuICAgIHRlbXBsYXRlVXJsOiAnL2NpcmN1aXRzL2NpcmN1aXRzLmh0bWwnXG4gICAgY29udHJvbGxlcjogY2lyY3VpdHNDdHJsXG4gIG5hdmJhclByb3ZpZGVyLmFkZCAnL2NpcmN1aXRzJywgJ0NpcmN1aXRzJywgMzBcblxuY2lyY3VpdHNDdHJsID0gKCRzY29wZSwgamVlYnVzKSAtPlxuICBcbiAgJHNjb3BlLmNpcmN1aXRzID17fVxuICBcbiAgJHNjb3BlLmdhZGdldHMgPVxuICAgIFBpcGU6XG4gICAgICBuYW1lOiAnUGlwZWxpbmUnXG4gICAgICBzaGFkZTogJ2xpZ2h0eWVsbG93J1xuICAgICAgaWNvbjogJ1xcdWYwNjEnICMgZmEtYXJyb3ctcmlnaHRcbiAgICAgIGlucHV0czogJ0luJ1xuICAgICAgb3V0cHV0czogJ091dCdcbiAgICBQcmludGVyOlxuICAgICAgc2hhZGU6ICdsaWdodGJsdWUnXG4gICAgICBpY29uOiAnXFx1ZjAyZicgIyBmYS1wcmludFxuICAgICAgaW5wdXRzOiAnSW4gSW4yJ1xuICAgIGNsb2NrOlxuICAgICAgc2hhZGU6ICdwaW5rJ1xuICAgICAgaWNvbjogJ1xcdWYwMTcnICMgZmEtY2xvY2stb1xuICAgICAgaW5wdXRzOiAnUmF0ZSdcbiAgICAgIG91dHB1dHM6ICdPdXQnXG4gICAgU3RlcEdlbjpcbiAgICAgIHNoYWRlOiAnbGlnaHRncmVlbidcbiAgICAgIGljb246ICdcXHVmMDEzJyAjIGZhLWNvZ1xuICAgICAgaW5wdXRzOiAnUGFyYW1zJ1xuICAgICAgb3V0cHV0czogJ091dCdcbiAgICBTU0I6XG4gICAgICBzaGFkZTogJ2xpZ2h0Z3JheSdcbiAgICAgIGljb246ICdcXHVmMGIyJyAjIGZhLWFycm93cy1hbHRcbiAgICAgIGlucHV0czogJ0NtZHMnXG4gICAgICBcbiAgJHNjb3BlLmNpcmN1aXQgPVxuICAgIGdhZGdldHM6XG4gICAgICBnMTogeyB4OiAxMjAsIHk6IDIyMCwgdGl0bGU6ICdHYWRnZXQgT25lJywgdHlwZTogJ1BpcGUnLCAgICB9XG4gICAgICBnMjogeyB4OiAzMDAsIHk6IDI1MCwgdGl0bGU6ICdHYWRnZXQgVHdvJywgdHlwZTogJ1ByaW50ZXInLCB9XG4gICAgICBnMzogeyB4OiAzMjAsIHk6ICA2MCwgdGl0bGU6ICdTdGVwR2VuLVgnLCAgdHlwZTogJ1N0ZXBHZW4nLCB9XG4gICAgICBnNDogeyB4OiA1NDAsIHk6ICA3MCwgdGl0bGU6ICdTU0ItWCcsICAgICAgdHlwZTogJ1NTQicsICAgICB9XG4gICAgICBnNTogeyB4OiAzNDAsIHk6IDE0MCwgdGl0bGU6ICdTdGVwR2VuLVknLCAgdHlwZTogJ1N0ZXBHZW4nLCB9XG4gICAgICBnNjogeyB4OiA1MjAsIHk6IDE1MCwgdGl0bGU6ICdTU0ItWScsICAgICAgdHlwZTogJ1NTQicsICAgICB9XG4gICAgd2lyZXM6XG4gICAgICAnZzEuT3V0L2cyLkluJzogMFxuICAgICAgJ2czLk91dC9nNC5DbWRzJzogMFxuICAgICAgJ2c1Lk91dC9nNi5DbWRzJzogMFxuICAgIGZlZWRzOlxuICAgICAgJ2cyLkluJzogWyAnc29tZSBkYXRhJywgeyBUYWc6ICdibGFoJywgTXNnOiAndGFnZ2VkIGRhdGEnIH0gXVxuICAgICAgJ2czLlBhcmFtcyc6IFsgMTAwMCwgNTAwIF1cbiAgICAgICdnNS5QYXJhbXMnOiBbIDUwMCwgMTAwMCBdXG4gICAgbGFiZWxzOlxuICAgICAgSW46ICdnMi5JbidcbiAgICAgIFxuICAkc2NvcGUuY2lyY3VpdCA9XG4gICAgZ2FkZ2V0czp7fVxuICAgIHdpcmVzOltdXG4gICAgZmVlZHM6W11cbiAgICAgIFxuICB1cGRhdGVQaW5MaXN0ID0gKCkgLT5cbiAgICAkc2NvcGUuaW5wdXRQaW5zID0gW11cbiAgICBmb3IgZ2lkLCBnIG9mICRzY29wZS5jaXJjdWl0LmdhZGdldHNcbiAgICAgIGlmIGlucyA9ICRzY29wZS5nYWRnZXRzW2cudHlwZV0uaW5wdXRzXG4gICAgICAgIGZvciBwIGluIGlucy5zcGxpdCAnICdcbiAgICAgICAgICAkc2NvcGUuaW5wdXRQaW5zLnB1c2ggXCIje2dpZH0uI3twfVwiXG4gICAgJHNjb3BlLmlucHV0UGlucy5zb3J0KClcbiAgXG4gICMgd2F0Y2ggY2lyY3VpdHMgZm9yIGNoYW5nZVxuICAkc2NvcGUuJHdhdGNoIFwiY2lyY3VpdHNcIiwgKChuZXdWYWx1ZSwgb2xkVmFsdWUpIC0+XG4gICAgb2xkID0gT2JqZWN0LmtleXMgb2xkVmFsdWVcbiAgICBhbmd1bGFyLmZvckVhY2ggbmV3VmFsdWUsICh2YWx1ZSwga2V5KSAtPlxuICAgICAgaWYgb2xkLmluZGV4T2Yga2V5IGlzIC0xICMgaWYga2V5IGRvZXMgbm90IGV4aXN0IGluIG9sZFZhbHVlLCBrZXkgYWRkXG4gICAgICAgICRzY29wZS5jaXJjdWl0LmdhZGdldHNba2V5XSA9IHZhbHVlXG4gICAgICAgIGNvbnNvbGUubG9nIFwib2JqZWN0ICN7a2V5fSBpcyBhZGRlZFwiLCB2YWx1ZVxuICAgICAgICBcbiAgICAgICAgaWYgdmFsdWUud2lyZT9cbiAgICAgICAgICBjb25zb2xlLmxvZyBcIndpcmVzOlwiLCB2YWx1ZS53aXJlXG4gICAgICAgICAgI1RPRE86IG91dHB1dHMgY2FuIGhhdmUgb3RoZXIgZm9ybXMgdGhhbiBcIk91dFwiXG4gICAgICAgICAgayA9IFwiI3trZXl9Lk91dC8je3ZhbHVlLndpcmUuT3V0fVwiXG4gICAgICAgICAgJHNjb3BlLmNpcmN1aXQud2lyZXNba10gPSAwXG5cbiAgICAgICAgaWYgdmFsdWUuZmVlZD9cbiAgICAgICAgICBjb25zb2xlLmxvZyB2YWx1ZS5mZWVkXG4gICAgICAgICAgJHNjb3BlLmNpcmN1aXQuZmVlZHMucHVzaCB2YWx1ZS5mZWVkXG4gICAgICAgICAgXG4gICAgICBpbmRleCA9IG9sZC5pbmRleE9mKGtleSkgIyByZW1vdmUgaXRlbSBmcm9tIG9sZFxuICAgICAgaWYgaW5kZXggPiAtMVxuICAgICAgICBvbGQuc3BsaWNlIGluZGV4LCAxXG4gICAgZm9yIGVhY2ggaW4gb2xkICAjIG9sZCBub3cgY29udGFpbnMgYWxsIGtleXMgdGhhdCBkbyBubyBvbmdlciBleGlzdCBpbiBuZXdWYWx1ZVxuICAgICAgIyBpbmRleCA9ICRzY29wZS5jaXJjdWl0LmdhZGdldHMuaW5kZXhPZihlYWNoKVxuICAgICAgIyAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzLnNwbGljZSBpbmRleCwgMVxuICAgICAgY29uc29sZS5sb2cgXCJ0aGlzIGtleSBpcyByZW1vdmVkOlwiLCBrZXlcbiAgICAgICAgICAgIFxuICApLCB0cnVlXG4gIFxuICAkc2NvcGUuJHdhdGNoICdhZGRQaW4nLCAocGluKSAtPlxuICAgIGlmIHBpblxuICAgICAgJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXSA/PSBbXVxuICAgICAgY29uc29sZS5sb2cgJ2FkZEZlZWQnLCBwaW4sICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl0ubGVuZ3RoXG4gICAgICAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dLnB1c2ggJydcbiAgICAgICRzY29wZS5hZGRQaW4gPSBudWxsXG5cbiAgJHNjb3BlLmRlbEZlZWQgPSAocGluLCBpbmRleCkgLT5cbiAgICBpdGVtcyA9ICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl1cbiAgICBjb25zb2xlLmxvZyAnZGVsRmVlZCcsIHBpbiwgaW5kZXgsIGl0ZW1zW2luZGV4XVxuICAgIGl0ZW1zLnNwbGljZSBpbmRleCwgMVxuICAgIGRlbGV0ZSAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dICBpZiBpdGVtcy5sZW5ndGggaXMgMFxuICBcbiAgJHNjb3BlLiR3YXRjaCAnY3VyclNlbC5pZCcsICh4KSAtPlxuICAgIGNvbnNvbGUubG9nICdmaXggaWQnLCB4XG4gICAgdXBkYXRlUGluTGlzdCgpICMgZm9yIG5ldyBhbmQgZGVsZXRlZCBnYWRnZXRzXG4gICRzY29wZS4kd2F0Y2ggJ2N1cnJTZWwudGl0bGUnLCAoeCkgLT5cbiAgICBjb25zb2xlLmxvZyAnZml4IHRpdGxlJywgeFxuICAgICAgXG4gIGhhbmRsZXJzID1cbiAgICBhZGRHYWRnZXQ6ICh4LCB5KSAtPiAgICAgIFxuICAgICAgaWYgJHNjb3BlLm5ld3R5cGU/IFxuICAgICAgICAjIGplZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWFnJywgb2JqfVxuICAgICAgICBpZD0gXCJnXCIgKyBTdHJpbmcgRGF0ZS5ub3coKSUxMjM0NTY3XG4gICAgICAgIHR5cGUgPSAkc2NvcGUubmV3dHlwZVxuICAgICAgICBvYmogPSB7dGl0bGU6XCIje3R5cGV9LSN7aWR9XCIsIHR5cGU6JHNjb3BlLm5ld3R5cGUsIHg6eCwgeTp5fVxuICAgICAgICBqZWVidXMucHV0IFwiL2NpcmN1aXQvZGVtbzEvI3tpZH1cIiwgb2JqICAgICAgICAgXG4gICAgZGVsR2FkZ2V0OiAoaWQpIC0+ICAgXG4gICAgICAjIGplZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWRnJywgb2JqLCBpZH0gICAgICBcbiAgICAgIGplZWJ1cy5wdXQgXCIvY2lyY3VpdC9kZW1vMS8je2lkfVwiICAjIHB1dCBuaWwgdmFsdWUgdG8gZGVsZXRlIGlkXG4gICAgYWRkV2lyZTogKGZyb20sIHRvKSAtPiAgIFxuICAgICAgI2plZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWF3Jywgb2JqLCBmcm9tLCB0byB9XG4gICAgICBpZCA9IChmcm9tLnNwbGl0ICcuJylbMF1cbiAgICAgIG9iaiA9ICRzY29wZS5jaXJjdWl0LmdhZGdldHNbaWRdXG4gICAgICBvYmoud2lyZSA9IHtcIk91dFwiOnRvfVxuICAgICAgamVlYnVzLnB1dCBcIi9jaXJjdWl0L2RlbW8xLyN7aWR9XCIsIG9iaiBcbiAgICBkZWxXaXJlOiAoZnJvbSwgdG8pIC0+ICAgICNqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1kdycsIG9iaiwgZnJvbSwgdG8gfVxuICAgICAgaWQgPSAoZnJvbS5zcGxpdCAnLicpWzBdXG4gICAgICBvYmogPSAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXVxuICAgICAgb2JqLndpcmUgPSBudWxsXG4gICAgICBqZWVidXMucHV0IFwiL2NpcmN1aXQvZGVtbzEvI3tpZH1cIiwgb2JqXG4gICAgc2VsZWN0R2FkZ2V0OiAoaWQpIC0+ICAgICAjamVlYnVzLnNlbmQgeyBjbWQ6ICdjZWQtc2cnLCBvYmosIGlkICAgICAgIH1cbiAgICBtb3ZlR2FkZ2V0OiAoaWQsIHgsIHkpIC0+ICNqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1tZycsIG9iaiwgaWQsIHgsIHkgfVxuICAgICAgb2JqID0gJHNjb3BlLmNpcmN1aXQuZ2FkZ2V0c1tpZF1cbiAgICAgIG9iai54ID0geFxuICAgICAgb2JqLnkgPSB5XG4gICAgICBqZWVidXMucHV0IFwiL2NpcmN1aXQvZGVtbzEvI3tpZH1cIiwgb2JqXG5cblxuICAkc2NvcGUuJG9uICdjaXJjdWl0JywgKGV2ZW50LCB0eXBlLCBhcmdzLi4uKSAtPlxuICAgIGNvbnNvbGUubG9nICdDOicsIHR5cGUsIGFyZ3MuLi5cbiAgICBoYW5kbGVyc1t0eXBlXSBhcmdzLi4uXG4gIFxuICAgIFxuICBzZXR1cCA9IC0+XG4gICAgamVlYnVzLmF0dGFjaCAnY2lyY3VpdC9kZW1vMSdcbiAgICAgLm9uICdzeW5jJywgKGFyZ3MuLi4pIC0+XG4gICAgICAgIHRlbXAgPSBAcm93c1xuICAgICAgICBmb3Igb2JqIGluIHRlbXBcbiAgICAgICAgICAkc2NvcGUuY2lyY3VpdHNbb2JqLmlkXSA9IG9ialxuICAgICAgICBjb25zb2xlLmxvZyBcImluaXQgY2lyY3VpdHNcIlxuICBcbiAgICAgLm9uICdkYXRhJywgKGFyZ3MuLi4pIC0+ICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2cgMTExLCBhcmdzXG4gICAgICBcbiAgICAgICAgIzEuIFRPRE86IGNoZWNrIGZvciB2YWx1ZSwgZWxzZSByZW1vdmVcbiAgICAgICAgIzIuIGFkZCB0byBjaXJjdWl0c1xuICAgICAgICAjICRzY29wZS5jaXJjdWl0cyBwdXNoIGssIHZcbiAgICAgICAgIzMuIHRlbGwgZWRpdG9yXG4gICAgIyBqZWVidXMuYXR0YWNoICdkZW1vJ1xuICAgICMgIC5vbiAnZGF0YScsIChhcmdzLi4uKSAtPlxuICAgICMgICAgIGNvbnNvbGUubG9nICdkYXRhLXRpbScsIGFyZ3NcbiAgICAgIFxuXG4gIHNldHVwKCkgIGlmICRzY29wZS5zZXJ2ZXJTdGF0dXMgaXMgJ2Nvbm5lY3RlZCdcbiAgJHNjb3BlLiRvbiAnd3Mtb3BlbicsIHNldHVwXG4iXX0=
