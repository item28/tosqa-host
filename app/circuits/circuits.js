(function() {
  var circuitsCtrl, ng,
    __slice = [].slice;

  ng = angular.module('myApp');

  ng.config(function($stateProvider, navbarProvider) {
    $stateProvider.state('circuits', {
      url: '/circuits',
      templateUrl: '/circuits/circuits.html',
      controller: circuitsCtrl
    });
    return navbarProvider.add('/circuits', 'Circuits', 30);
  });

  circuitsCtrl = function($scope, jeebus) {
    var handlers, updatePinList;
    $scope.gadgets = {
      Pipe: {
        name: 'Pipeline',
        width: 160,
        shade: 'lightyellow',
        icon: '\uf061',
        pins: [
          {
            name: 'In',
            dir: 'in'
          }, {
            name: 'Out',
            dir: 'out'
          }
        ]
      },
      Printer: {
        width: 120,
        shade: 'lightblue',
        icon: '\uf02f',
        pins: [
          {
            name: 'In',
            dir: 'in'
          }, {
            name: 'In2',
            dir: 'in'
          }
        ]
      }
    };
    $scope.circuit = {
      gadgets: [
        {
          id: 'g1',
          x: 120,
          y: 100,
          title: 'Gadget One',
          type: 'Printer'
        }, {
          id: 'g2',
          x: 120,
          y: 200,
          title: 'Gadget Two',
          type: 'Pipe'
        }
      ],
      wires: [
        {
          from: 'g2.Out',
          to: 'g1.In',
          cap: 0
        }
      ],
      feeds: {
        'g1.In': [
          'some data', {
            Tag: 'blah',
            Msg: 'tagged data'
          }
        ]
      },
      labels: {
        In: 'g2.In'
      }
    };
    updatePinList = function() {
      var g, p, _i, _j, _len, _len1, _ref, _ref1;
      $scope.inputPins = [];
      _ref = $scope.circuit.gadgets;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        g = _ref[_i];
        _ref1 = $scope.gadgets[g.type].pins;
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          p = _ref1[_j];
          if (p.dir === 'in') {
            $scope.inputPins.push("" + g.id + "." + p.name);
          }
        }
      }
      return $scope.inputPins.sort();
    };
    $scope.$watch('addPin', function(pin) {
      var _base;
      if (pin) {
        if ((_base = $scope.circuit.feeds)[pin] == null) {
          _base[pin] = [];
        }
        console.log('addFeed', pin, $scope.circuit.feeds[pin].length);
        $scope.circuit.feeds[pin].push('');
        return $scope.addPin = null;
      }
    });
    $scope.delFeed = function(pin, index) {
      var items;
      items = $scope.circuit.feeds[pin];
      console.log('delFeed', pin, index, items[index]);
      items.splice(index, 1);
      if (items.length === 0) {
        return delete $scope.circuit.feeds[pin];
      }
    };
    $scope.$watch('currSel.id', function(x) {
      console.log('fix id', x);
      return updatePinList();
    });
    $scope.$watch('currSel.title', function(x) {
      return console.log('fix title', x);
    });
    handlers = {
      addGadget: function(x, y) {},
      delGadget: function(id) {},
      addWire: function(from, to) {},
      delWire: function(from, to) {},
      selectGadget: function(id) {},
      moveGadget: function(id, x, y) {}
    };
    return $scope.$on('circuit', function() {
      var args, event, type;
      event = arguments[0], type = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      console.log.apply(console, ['C:', type].concat(__slice.call(args)));
      return handlers[type].apply(handlers, args);
    });
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY3VpdHMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxnQkFBQTtJQUFBLGtCQUFBOztBQUFBLEVBQUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxNQUFSLENBQWUsT0FBZixDQUFMLENBQUE7O0FBQUEsRUFFQSxFQUFFLENBQUMsTUFBSCxDQUFVLFNBQUMsY0FBRCxFQUFpQixjQUFqQixHQUFBO0FBQ1IsSUFBQSxjQUFjLENBQUMsS0FBZixDQUFxQixVQUFyQixFQUNFO0FBQUEsTUFBQSxHQUFBLEVBQUssV0FBTDtBQUFBLE1BQ0EsV0FBQSxFQUFhLHlCQURiO0FBQUEsTUFFQSxVQUFBLEVBQVksWUFGWjtLQURGLENBQUEsQ0FBQTtXQUlBLGNBQWMsQ0FBQyxHQUFmLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLEVBQTRDLEVBQTVDLEVBTFE7RUFBQSxDQUFWLENBRkEsQ0FBQTs7QUFBQSxFQVNBLFlBQUEsR0FBZSxTQUFDLE1BQUQsRUFBUyxNQUFULEdBQUE7QUFFYixRQUFBLHVCQUFBO0FBQUEsSUFBQSxNQUFNLENBQUMsT0FBUCxHQUNFO0FBQUEsTUFBQSxJQUFBLEVBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxVQUFOO0FBQUEsUUFDQSxLQUFBLEVBQU8sR0FEUDtBQUFBLFFBRUEsS0FBQSxFQUFPLGFBRlA7QUFBQSxRQUdBLElBQUEsRUFBTSxRQUhOO0FBQUEsUUFJQSxJQUFBLEVBQU07VUFDSjtBQUFBLFlBQUUsSUFBQSxFQUFNLElBQVI7QUFBQSxZQUFjLEdBQUEsRUFBSyxJQUFuQjtXQURJLEVBRUo7QUFBQSxZQUFFLElBQUEsRUFBTSxLQUFSO0FBQUEsWUFBZSxHQUFBLEVBQUssS0FBcEI7V0FGSTtTQUpOO09BREY7QUFBQSxNQVNBLE9BQUEsRUFDRTtBQUFBLFFBQUEsS0FBQSxFQUFPLEdBQVA7QUFBQSxRQUNBLEtBQUEsRUFBTyxXQURQO0FBQUEsUUFFQSxJQUFB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QSxFQUFNLElBQU0sU0FBQSxhQUFBLElBQUEsQ0FBQSxDQUF4QixDQUFBLENBQUE7YUFDQSxRQUFTLENBQUEsSUFBQSxDQUFULGlCQUFlLElBQWYsRUFGb0I7SUFBQSxDQUF0QixFQXBFYTtFQUFBLENBVGYsQ0FBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsibmcgPSBhbmd1bGFyLm1vZHVsZSAnbXlBcHAnXG5cbm5nLmNvbmZpZyAoJHN0YXRlUHJvdmlkZXIsIG5hdmJhclByb3ZpZGVyKSAtPlxuICAkc3RhdGVQcm92aWRlci5zdGF0ZSAnY2lyY3VpdHMnLFxuICAgIHVybDogJy9jaXJjdWl0cydcbiAgICB0ZW1wbGF0ZVVybDogJy9jaXJjdWl0cy9jaXJjdWl0cy5odG1sJ1xuICAgIGNvbnRyb2xsZXI6IGNpcmN1aXRzQ3RybFxuICBuYXZiYXJQcm92aWRlci5hZGQgJy9jaXJjdWl0cycsICdDaXJjdWl0cycsIDMwXG5cbmNpcmN1aXRzQ3RybCA9ICgkc2NvcGUsIGplZWJ1cykgLT5cbiAgICBcbiAgJHNjb3BlLmdhZGdldHMgPVxuICAgIFBpcGU6XG4gICAgICBuYW1lOiAnUGlwZWxpbmUnXG4gICAgICB3aWR0aDogMTYwXG4gICAgICBzaGFkZTogJ2xpZ2h0eWVsbG93J1xuICAgICAgaWNvbjogJ1xcdWYwNjEnICMgZmEtYXJyb3ctcmlnaHRcbiAgICAgIHBpbnM6IFtcbiAgICAgICAgeyBuYW1lOiAnSW4nLCBkaXI6ICdpbicgfVxuICAgICAgICB7IG5hbWU6ICdPdXQnLCBkaXI6ICdvdXQnIH1cbiAgICAgIF1cbiAgICBQcmludGVyOlxuICAgICAgd2lkdGg6IDEyMFxuICAgICAgc2hhZGU6ICdsaWdodGJsdWUnXG4gICAgICBpY29uOiAnXFx1ZjAyZicgIyBmYS1wcmludFxuICAgICAgcGluczogW1xuICAgICAgICB7IG5hbWU6ICdJbicsIGRpcjogJ2luJyB9XG4gICAgICAgIHsgbmFtZTogJ0luMicsIGRpcjogJ2luJyB9XG4gICAgICBdXG4gICAgICBcbiAgJHNjb3BlLmNpcmN1aXQgPVxuICAgIGdhZGdldHM6IFtcbiAgICAgIHsgaWQ6ICdnMScsIHg6IDEyMCwgeTogMTAwLCB0aXRsZTogJ0dhZGdldCBPbmUnLCB0eXBlOiAnUHJpbnRlcicgfVxuICAgICAgeyBpZDogJ2cyJywgeDogMTIwLCB5OiAyMDAsIHRpdGxlOiAnR2FkZ2V0IFR3bycsIHR5cGU6ICdQaXBlJyB9XG4gICAgXVxuICAgIHdpcmVzOiBbXG4gICAgICB7IGZyb206ICdnMi5PdXQnLCB0bzogJ2cxLkluJywgY2FwOiAwIH1cbiAgICBdXG4gICAgZmVlZHM6XG4gICAgICAnZzEuSW4nOiBbICdzb21lIGRhdGEnLCB7IFRhZzogJ2JsYWgnLCBNc2c6ICd0YWdnZWQgZGF0YScgfSBdXG4gICAgbGFiZWxzOlxuICAgICAgSW46ICdnMi5JbidcbiAgICAgIFxuICB1cGRhdGVQaW5MaXN0ID0gKCkgLT5cbiAgICAkc2NvcGUuaW5wdXRQaW5zID0gW11cbiAgICBmb3IgZyBpbiAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzXG4gICAgICBmb3IgcCBpbiAkc2NvcGUuZ2FkZ2V0c1tnLnR5cGVdLnBpbnMgd2hlbiBwLmRpciBpcyAnaW4nXG4gICAgICAgICRzY29wZS5pbnB1dFBpbnMucHVzaCBcIiN7Zy5pZH0uI3twLm5hbWV9XCJcbiAgICAkc2NvcGUuaW5wdXRQaW5zLnNvcnQoKVxuICBcbiAgJHNjb3BlLiR3YXRjaCAnYWRkUGluJywgKHBpbikgLT5cbiAgICBpZiBwaW5cbiAgICAgICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl0gPz0gW11cbiAgICAgIGNvbnNvbGUubG9nICdhZGRGZWVkJywgcGluLCAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dLmxlbmd0aFxuICAgICAgJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXS5wdXNoICcnXG4gICAgICAkc2NvcGUuYWRkUGluID0gbnVsbFxuICAgIFxuICAkc2NvcGUuZGVsRmVlZCA9IChwaW4sIGluZGV4KSAtPlxuICAgIGl0ZW1zID0gJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXVxuICAgIGNvbnNvbGUubG9nICdkZWxGZWVkJywgcGluLCBpbmRleCwgaXRlbXNbaW5kZXhdXG4gICAgaXRlbXMuc3BsaWNlIGluZGV4LCAxXG4gICAgZGVsZXRlICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl0gIGlmIGl0ZW1zLmxlbmd0aCBpcyAwXG4gIFxuICAkc2NvcGUuJHdhdGNoICdjdXJyU2VsLmlkJywgKHgpIC0+XG4gICAgY29uc29sZS5sb2cgJ2ZpeCBpZCcsIHhcbiAgICB1cGRhdGVQaW5MaXN0KCkgIyBmb3IgbmV3IGFuZCBkZWxldGVkIGdhZGdldHNcbiAgJHNjb3BlLiR3YXRjaCAnY3VyclNlbC50aXRsZScsICh4KSAtPlxuICAgIGNvbnNvbGUubG9nICdmaXggdGl0bGUnLCB4XG4gIFxuICBoYW5kbGVycyA9XG4gICAgYWRkR2FkZ2V0OiAoeCwgeSkgLT5cbiAgICBkZWxHYWRnZXQ6IChpZCkgLT5cbiAgICBhZGRXaXJlOiAoZnJvbSwgdG8pIC0+XG4gICAgZGVsV2lyZTogKGZyb20sIHRvKSAtPlxuICAgIHNlbGVjdEdhZGdldDogKGlkKSAtPlxuICAgIG1vdmVHYWRnZXQ6IChpZCwgeCwgeSkgLT5cbiAgICAgIFxuICAkc2NvcGUuJG9uICdjaXJjdWl0JywgKGV2ZW50LCB0eXBlLCBhcmdzLi4uKSAtPlxuICAgIGNvbnNvbGUubG9nICdDOicsIHR5cGUsIGFyZ3MuLi5cbiAgICBoYW5kbGVyc1t0eXBlXSBhcmdzLi4uXG4gICAgXG4gICMgc2V0dXAgPSAtPlxuICAjICAgamVlYnVzLmF0dGFjaCAnY2lyY3VpdCdcbiAgIyAgICAgLm9uICdzeW5jJywgLT5cbiAgIyAgICAgICAkc2NvcGUuY2lyY3VpdHMgPSBAcm93c1xuICAjICAgICBcbiAgIyBzZXR1cCgpICBpZiAkc2NvcGUuc2VydmVyU3RhdHVzIGlzICdjb25uZWN0ZWQnXG4gICMgJHNjb3BlLiRvbiAnd3Mtb3BlbicsIHNldHVwXG4iXX0=
