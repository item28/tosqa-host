(function() {
  var gadgetTypes, ng;

  ng = angular.module('myApp');

  gadgetTypes = {
    Pipe: {
      width: 80,
      height: 60,
      shade: 'lightyellow',
      pins: [
        {
          name: 'In',
          type: 'i'
        }, {
          name: 'Out',
          type: 'o'
        }
      ]
    },
    Printer: {
      width: 120,
      height: 40,
      shade: 'lightblue',
      pins: [
        {
          name: 'In',
          type: 'i'
        }
      ]
    }
  };

  ng.directive('circuitEditor', function() {
    return {
      restrict: 'E',
      scope: {
        data: '='
      },
      link: function(scope, elem, attr) {
        var diag, g, gadgetDrag, gadgets, svg, wireDrag, wires;
        svg = d3.select(elem[0]).append('svg').attr({
          width: 900,
          height: 400
        });
        gadgetDrag = d3.behavior.drag().origin(Object).on('dragstart', function(d) {
          return this.parentNode.appendChild(this);
        }).on('drag', function(d) {
          d.x = d3.event.x | 0;
          d.y = d3.event.y | 0;
          return d3.select(this).attr({
            transform: function(d) {
              return "translate(" + d.x + "," + d.y + ")";
            }
          });
        }).on('dragend', function(d) {
          return console.log('save gadget', d);
        });
        wireDrag = d3.behavior.drag().origin(Object).on('dragstart', function(d) {
          console.log('wireDrag', d);
          this.parentNode.appendChild(this);
          return d3.event.sourceEvent.stopPropagation();
        }).on('drag', function(d) {
          d.x = d3.event.x;
          d.y = d3.event.y;
          return d3.select(this).attr({
            transform: function(d) {
              return "translate(" + d.x + "," + d.y + ")";
            }
          });
        }).on('dragend', function(d) {
          return console.log('save wire', d);
        });
        diag = d3.svg.diagonal();
        gadgets = svg.selectAll('.gadget').data(scope.data.gadgets);
        g = gadgets.enter().append('g').call(gadgetDrag).attr({
          "class": 'gadget'
        }).each(function(d) {
          d.gt = gadgetTypes[d.type];
          d.hw = d.gt.width / 2;
          return d.hh = d.gt.height / 2;
        });
        g.append('rect').each(function(d) {
          return d3.select(this).attr({
            x: 0.5 - d.hw,
            y: 0.5 - d.hh,
            width: 2 * d.hw,
            height: 2 * d.hh
          });
        }).style({
          fill: function(d) {
            return d.gt.shade;
          }
        });
        g.append('text').text(function(d) {
          return d.title;
        }).attr({
          "class": 'title',
          y: function(d) {
            return 12 - d.hh;
          }
        });
        g.append('text').text(function(d) {
          return d.type;
        }).attr({
          "class": 'type',
          y: function(d) {
            return -4 + d.hh;
          }
        });
        g.append('circle').on('mousedown', function(d) {
          console.log('c1', d);
          return d3.event.sourceEvent.stopPropagation();
        }).attr({
          "class": 'pin',
          cx: (function(d) {
            return 0.5 - d.hw;
          }),
          r: 3
        });
        g.append('circle').on('mousedown', function(d) {
          console.log('c2', d);
          return d3.event.sourceEvent.stopPropagation();
        }).attr({
          "class": 'pin',
          cx: (function(d) {
            return 0.5 + d.hw;
          }),
          r: 3
        });
        diag.source(scope.data.gadgets[0]);
        diag.target(scope.data.gadgets[1]);
        wires = svg.selectAll('.wire').data(scope.data.gadgets);
        wires.enter().append('path').attr({
          "class": 'wire',
          d: diag
        });
        return gadgets.attr({
          transform: function(d) {
            return "translate(" + d.x + "," + d.y + ")";
          }
        });
      }
    };
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY2VkaXQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxlQUFBOztBQUFBLEVBQUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxNQUFSLENBQWUsT0FBZixDQUFMLENBQUE7O0FBQUEsRUFFQSxXQUFBLEdBQ0U7QUFBQSxJQUFBLElBQUEsRUFDRTtBQUFBLE1BQUEsS0FBQSxFQUFPLEVBQVA7QUFBQSxNQUNBLE1BQUEsRUFBUSxFQURSO0FBQUEsTUFFQSxLQUFBLEVBQU8sYUFGUDtBQUFBLE1BR0EsSUFBQSxFQUFNO1FBQ0o7QUFBQSxVQUFFLElBQUEsRUFBSyxJQUFQO0FBQUEsVUFBYSxJQUFBLEVBQUssR0FBbEI7U0FESSxFQUVKO0FBQUEsVUFBRSxJQUFBLEVBQUssS0FBUDtBQUFBLFVBQWMsSUFBQSxFQUFLLEdBQW5CO1NBRkk7T0FITjtLQURGO0FBQUEsSUFRQSxPQUFBLEVBQ0U7QUFBQSxNQUFBLEtBQUEsRUFBTyxHQUFQO0FBQUEsTUFDQSxNQUFBLEVBQVEsRUFEUjtBQUFBLE1BRUEsS0FBQSxFQUFPLFdBRlA7QUFBQSxNQUdBLElBQUEsRUFBTTtRQUNKO0FBQUEsVUFBRSxJQUFBLEVBQUssSUFBUDtBQUFBLFVBQWEsSUFBQSxFQUFLLEdBQWxCO1NBREk7T0FITjtLQVRGO0dBSEYsQ0FBQTs7QUFBQSxFQW1CQSxFQUFFLENBQUMsU0FBSCxDQUFhLGVBQWIsRUFBOEIsU0FBQSxHQUFBO1dBQzVCO0FBQUEsTUFBQSxRQUFBLEVBQVUsR0FBVjtBQUFBLE1BRUEsS0FBQSxFQUNFO0FBQUEsUUFBQSxJQUFBLEVBQU0sR0FBTjtPQUhGO0FBQUEsTUFLQSxJQUFBLEVBQU0sU0FBQyxLQUFELEVBQVEsSUFBUixFQUFjLElBQWQsR0FBQTtBQUNKLFlBQUEsa0RBQUE7QUFBQSxRQUFBLEdBQUEsR0FBTSxFQUFFLENBQUMsTUFBSCxDQUFVLElBQUssQ0FBQSxDQUFBLENBQWYsQ0FB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QUFBLEVBRmU7UUFBQSxDQURuQixDQUlFLENBQUMsSUFKSCxDQUlRO0FBQUEsVUFBQSxPQUFBLEVBQU8sS0FBUDtBQUFBLFVBQWMsRUFBQSxFQUFJLENBQUMsU0FBQyxDQUFELEdBQUE7bUJBQU8sR0FBQSxHQUFNLENBQUMsQ0FBQyxHQUFmO1VBQUEsQ0FBRCxDQUFsQjtBQUFBLFVBQXVDLENBQUEsRUFBRyxDQUExQztTQUpSLENBNURBLENBQUE7QUFBQSxRQW1FQSxJQUFJLENBQUMsTUFBTCxDQUFZLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBUSxDQUFBLENBQUEsQ0FBL0IsQ0FuRUEsQ0FBQTtBQUFBLFFBb0VBLElBQUksQ0FBQyxNQUFMLENBQVksS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFRLENBQUEsQ0FBQSxDQUEvQixDQXBFQSxDQUFBO0FBQUEsUUFzRUEsS0FBQSxHQUFRLEdBQUcsQ0FBQyxTQUFKLENBQWMsT0FBZCxDQUFzQixDQUFDLElBQXZCLENBQTRCLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBdkMsQ0F0RVIsQ0FBQTtBQUFBLFFBdUVBLEtBQUssQ0FBQyxLQUFOLENBQUEsQ0FBYSxDQUFDLE1BQWQsQ0FBcUIsTUFBckIsQ0FDRSxDQUFDLElBREgsQ0FDUTtBQUFBLFVBQUEsT0FBQSxFQUFPLE1BQVA7QUFBQSxVQUFlLENBQUEsRUFBRyxJQUFsQjtTQURSLENBdkVBLENBQUE7ZUEwRUEsT0FBTyxDQUFDLElBQVIsQ0FDRTtBQUFBLFVBQUEsU0FBQSxFQUFXLFNBQUMsQ0FBRCxHQUFBO21CQUFRLFlBQUEsR0FBVyxDQUFDLENBQUMsQ0FBYixHQUFnQixHQUFoQixHQUFrQixDQUFDLENBQUMsQ0FBcEIsR0FBdUIsSUFBL0I7VUFBQSxDQUFYO1NBREYsRUEzRUk7TUFBQSxDQUxOO01BRDRCO0VBQUEsQ0FBOUIsQ0FuQkEsQ0FBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsibmcgPSBhbmd1bGFyLm1vZHVsZSAnbXlBcHAnXG5cbmdhZGdldFR5cGVzID1cbiAgUGlwZTpcbiAgICB3aWR0aDogODBcbiAgICBoZWlnaHQ6IDYwXG4gICAgc2hhZGU6ICdsaWdodHllbGxvdydcbiAgICBwaW5zOiBbXG4gICAgICB7IG5hbWU6J0luJywgdHlwZTonaScgfVxuICAgICAgeyBuYW1lOidPdXQnLCB0eXBlOidvJyB9XG4gICAgXVxuICBQcmludGVyOlxuICAgIHdpZHRoOiAxMjBcbiAgICBoZWlnaHQ6IDQwXG4gICAgc2hhZGU6ICdsaWdodGJsdWUnXG4gICAgcGluczogW1xuICAgICAgeyBuYW1lOidJbicsIHR5cGU6J2knIH1cbiAgICBdXG5cbm5nLmRpcmVjdGl2ZSAnY2lyY3VpdEVkaXRvcicsIC0+XG4gIHJlc3RyaWN0OiAnRSdcbiAgXG4gIHNjb3BlOlxuICAgIGRhdGE6ICc9J1xuICAgIFxuICBsaW5rOiAoc2NvcGUsIGVsZW0sIGF0dHIpIC0+XG4gICAgc3ZnID0gZDMuc2VsZWN0KGVsZW1bMF0pLmFwcGVuZCAnc3ZnJ1xuICAgICAgLmF0dHIgd2lkdGg6IDkwMCwgaGVpZ2h0OiA0MDBcblxuICAgIGdhZGdldERyYWcgPSBkMy5iZWhhdmlvci5kcmFnKClcbiAgICAgIC5vcmlnaW4gT2JqZWN0XG4gICAgICAub24gJ2RyYWdzdGFydCcsIChkKSAtPlxuICAgICAgICBAcGFyZW50Tm9kZS5hcHBlbmRDaGlsZCBAICMgbW92ZSB0byBmcm9udFxuICAgICAgLm9uICdkcmFnJywgKGQpIC0+XG4gICAgICAgIGQueCA9IGQzLmV2ZW50LnggfCAwICMgc3RheSBvbiBpbnQgY29vcmRpbmF0ZXNcbiAgICAgICAgZC55ID0gZDMuZXZlbnQueSB8IDAgIyBzdGF5IG9uIGludCBjb29yZGluYXRlc1xuICAgICAgICBkMy5zZWxlY3QoQCkuYXR0clxuICAgICAgICAgIHRyYW5zZm9ybTogKGQpIC0+IFwidHJhbnNsYXRlKCN7ZC54fSwje2QueX0pXCJcbiAgICAgIC5vbiAnZHJhZ2VuZCcsIChkKSAtPlxuICAgICAgICBjb25zb2xlLmxvZyAnc2F2ZSBnYWRnZXQnLCBkICMgVE9ETzogc2F2ZSB0byBzZXJ2ZXJcblxuICAgIHdpcmVEcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpXG4gICAgICAub3JpZ2luIE9iamVjdFxuICAgICAgLm9uICdkcmFnc3RhcnQnLCAoZCkgLT5cbiAgICAgICAgY29uc29sZS5sb2cgJ3dpcmVEcmFnJywgZFxuICAgICAgICBAcGFyZW50Tm9kZS5hcHBlbmRDaGlsZCBAICMgbW92ZSB0byBmcm9udFxuICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgLm9uICdkcmFnJywgKGQpIC0+XG4gICAgICAgIGQueCA9IGQzLmV2ZW50LnhcbiAgICAgICAgZC55ID0gZDMuZXZlbnQueVxuICAgICAgICBkMy5zZWxlY3QoQCkuYXR0clxuICAgICAgICAgIHRyYW5zZm9ybTogKGQpIC0+IFwidHJhbnNsYXRlKCN7ZC54fSwje2QueX0pXCJcbiAgICAgIC5vbiAnZHJhZ2VuZCcsIChkKSAtPlxuICAgICAgICBjb25zb2xlLmxvZyAnc2F2ZSB3aXJlJywgZCAjIFRPRE86IHNhdmUgdG8gc2VydmVyXG5cbiAgICBkaWFnID0gZDMuc3ZnLmRpYWdvbmFsKClcbiAgICBcbiAgICBnYWRnZXRzID0gc3ZnLnNlbGVjdEFsbCgnLmdhZGdldCcpLmRhdGEoc2NvcGUuZGF0YS5nYWRnZXRzKVxuICBcbiAgICBnID0gZ2FkZ2V0cy5lbnRlcigpLmFwcGVuZCgnZycpLmNhbGwoZ2FkZ2V0RHJhZylcbiAgICAgIC5hdHRyIGNsYXNzOiAnZ2FkZ2V0J1xuICAgICAgLmVhY2ggKGQpIC0+XG4gICAgICAgIGQuZ3QgPSBnYWRnZXRUeXBlc1tkLnR5cGVdXG4gICAgICAgIGQuaHcgPSBkLmd0LndpZHRoIC8gMlxuICAgICAgICBkLmhoID0gZC5ndC5oZWlnaHQgLyAyXG4gICAgZy5hcHBlbmQoJ3JlY3QnKVxuICAgICAgLmVhY2ggKGQpIC0+XG4gICAgICAgIGQzLnNlbGVjdChAKS5hdHRyXG4gICAgICAgICAgIyAxcHggbGluZXMgcmVuZGVyIHNoYXJwbHkgd2hlbiBvbiBhIDAuNXB4IG9mZnNldFxuICAgICAgICAgIHg6IDAuNSAtIGQuaHdcbiAgICAgICAgICB5OiAwLjUgLSBkLmhoXG4gICAgICAgICAgd2lkdGg6IDIgKiBkLmh3XG4gICAgICAgICAgaGVpZ2h0OiAyICogZC5oaFxuICAgICAgLnN0eWxlXG4gICAgICAgIGZpbGw6IChkKSAtPiBkLmd0LnNoYWRlXG4gICAgZy5hcHBlbmQoJ3RleHQnKVxuICAgICAgLnRleHQgKGQpIC0+IGQudGl0bGVcbiAgICAgIC5hdHRyIGNsYXNzOiAndGl0bGUnLCB5OiAoZCkgLT4gMTIgLSBkLmhoXG4gICAgZy5hcHBlbmQoJ3RleHQnKVxuICAgICAgLnRleHQgKGQpIC0+IGQudHlwZVxuICAgICAgLmF0dHIgY2xhc3M6ICd0eXBlJywgeTogKGQpIC0+IC00ICsgZC5oaFxuICAgIGcuYXBwZW5kKCdjaXJjbGUnKVxuICAgICAgLm9uICdtb3VzZWRvd24nLCAoZCkgLT5cbiAgICAgICAgY29uc29sZS5sb2cgJ2MxJywgZFxuICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgLmF0dHIgY2xhc3M6ICdwaW4nLCBjeDogKChkKSAtPiAwLjUgLSBkLmh3KSwgcjogM1xuICAgIGcuYXBwZW5kKCdjaXJjbGUnKVxuICAgICAgLm9uICdtb3VzZWRvd24nLCAoZCkgLT5cbiAgICAgICAgY29uc29sZS5sb2cgJ2MyJywgZFxuICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgLmF0dHIgY2xhc3M6ICdwaW4nLCBjeDogKChkKSAtPiAwLjUgKyBkLmh3KSwgcjogM1xuXG4gICAgIyBGSVhNRVxuICAgIGRpYWcuc291cmNlIHNjb3BlLmRhdGEuZ2FkZ2V0c1swXVxuICAgIGRpYWcudGFyZ2V0IHNjb3BlLmRhdGEuZ2FkZ2V0c1sxXVxuXG4gICAgd2lyZXMgPSBzdmcuc2VsZWN0QWxsKCcud2lyZScpLmRhdGEoc2NvcGUuZGF0YS5nYWRnZXRzKVxuICAgIHdpcmVzLmVudGVyKCkuYXBwZW5kKCdwYXRoJylcbiAgICAgIC5hdHRyIGNsYXNzOiAnd2lyZScsIGQ6IGRpYWdcblxuICAgIGdhZGdldHMuYXR0clxuICAgICAgdHJhbnNmb3JtOiAoZCkgLT4gXCJ0cmFuc2xhdGUoI3tkLnh9LCN7ZC55fSlcIlxuIl19
